#!/usr/bin/env bash

set -o errexit
set -o pipefail

if [ "$1" == "-h" ] || [ "$1" == "-?" ] || [ "$1" == "--help" ]; then
    echo "$0 <dotfiles install dir>"
    echo "Existing dotfiles will be moved to <filename>.old"
    exit
fi

INSTALLDIR=$HOME
[ -n "$1" ] && INSTALLDIR="$1"

for i in .vimrc .vim .gitignore_global .emacs
do
	echo "install ${i}"
	if [ -e $INSTALLDIR/$i ]; then
		if [ -L $INSTALLDIR/$i ]; then
			unlink $INSTALLDIR/$i 
		else
			mv -n $INSTALLDIR/$i $INSTALLDIR/$i.old 
		fi
	fi
	ln -s $PWD/$i $INSTALLDIR/$i;
	echo "install ${i} completed"
done;

